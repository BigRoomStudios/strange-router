{"version":3,"file":"strange-router.umd.min.js","sources":["../lib/index.js"],"sourcesContent":["'use strict';\n\nconst React = require('react');\nconst PropTypes = require('prop-types');\nconst { Routes, Route, Navigate } = require('react-router');\n\nconst internals = {};\n\nexports.AppRoutes = class AppRoutes extends React.Component {\n\n    render() {\n\n        const { routes } = this.props;\n        const { renderRoute } = internals;\n\n        return Array.isArray(routes) ?\n            <Routes>\n                {routes.map(renderRoute)}\n            </Routes> :\n            <Routes>\n                {renderRoute(routes)}\n            </Routes>;\n    }\n};\n\nexports.AppRoutes.propTypes = {\n    routes: PropTypes.oneOfType([\n        PropTypes.object,\n        PropTypes.arrayOf(PropTypes.object)\n    ]).isRequired\n};\n\ninternals.renderRoute = (route) => {\n\n    if (route.redirect) {\n\n        // Redirect is special and must be exclusive of other props\n        const { redirect, ...rest } = route;\n\n        if (Object.keys(rest).length !== 0) {\n            throw new Error(`No other properties are allowed alongside \"redirect\" in route configuration. Check childRoutes of \"${route.path}\".`);\n        }\n\n        const { from, to } = redirect;\n        const redirectProps = { ...redirect };\n\n        if (typeof from === 'string') {\n            // redirect.from must be relative\n            redirectProps.from = internals.concatPaths(from);\n        }\n\n        if (typeof to === 'string') {\n            // If redirect.to is absolute, leave it be. Otherwise make it relative\n            redirectProps.to = to.startsWith('/') ? to : internals.concatPaths(to);\n        }\n        else if (to && typeof to.pathname === 'string') {\n            // to is an object\n            redirectProps.to = {\n                ...redirectProps.to,\n                pathname: to.pathname.startsWith('/') ? to.pathname : internals.concatPaths(to.pathname)\n            };\n        }\n\n        return <Route path='*' element={<Navigate to={redirectProps.to} replace/>}/>;\n    }\n\n    const normalizedPath = internals.concatPaths(route.path, route.exact);\n    const { renderRoute } = internals;\n    const RouteComponent = route.component || route.render;\n    const { RouteComponentLifecycleWrapper } = internals;\n\n    const Element = RouteComponentLifecycleWrapper.nonTrivial(route) ?\n        <RouteComponentLifecycleWrapper route={route} children={RouteComponent}/> :\n        RouteComponent;\n\n    return (\n        <Route\n            key={route.path}\n            path={normalizedPath}\n            strict={route.strict}\n            sensitive={route.sensitive}\n            element={<Element/>}\n        >\n            {route?.childRoutes?.map(renderRoute)}\n        </Route>\n    );\n};\n\ninternals.RouteComponentLifecycleWrapper = class RouteComponentLifecycleWrapper extends React.PureComponent {\n\n    constructor(props) {\n\n        super();\n\n        const { route } = props;\n\n        if (route.componentDidCatch) {\n            this.componentDidCatch = (err, info) => route.componentDidCatch({ err, info, ...this.props });\n        }\n\n        if (route.onWillMount) {\n            this.componentWillMount = () => route.onWillMount(this.props);\n        }\n\n        if (route.onDidMount) {\n            this.componentDidMount = () => route.onDidMount(this.props);\n        }\n\n        if (route.onWillUnmount) {\n            this.componentWillUnmount = () => route.onWillUnmount(this.props);\n        }\n    }\n\n    render() {\n\n        return this.props.children;\n    }\n};\n\ninternals.RouteComponentLifecycleWrapper.propTypes = {\n    route: PropTypes.object.isRequired\n};\n\ninternals.RouteComponentLifecycleWrapper.nonTrivial = (route) => {\n\n    return route.componentDidCatch ||\n        route.onWillMount ||\n        route.onDidMount ||\n        route.onWillUnmount;\n};\n\ninternals.concatPaths = (path, exact = false) => {\n\n    // base = base.endsWith('/') ? base.slice(0, -1) : base; // /my-path/ -> /my-path\n    path = path.startsWith('/') ? path.slice(1) : path;   // /my-path -> my-path\n\n    // return `${base}/${path}`;\n    return `${path}${exact ? '/*' : ''}`;\n};\n\n"],"names":["Routes","Route","Navigate","internals","exports","_React$Component","_inherits","AppRoutes","_super","_createSuper","_classCallCheck","this","apply","arguments","_createClass","key","value","routes","props","renderRoute","Array","isArray","React","createElement","map","Component","propTypes","PropTypes","oneOfType","object","arrayOf","isRequired","route","_route$childRoutes","redirect","rest","_excluded","Object","keys","length","Error","concat","path","from","to","redirectProps","concatPaths","startsWith","pathname","element","replace","normalizedPath","exact","RouteComponent","component","render","RouteComponentLifecycleWrapper","Element","nonTrivial","children","strict","sensitive","childRoutes","_React$PureComponent","_super2","_this","call","componentDidCatch","err","info","_objectSpread","onWillMount","componentWillMount","onDidMount","componentDidMount","onWillUnmount","componentWillUnmount","PureComponent","slice"],"mappings":"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"}